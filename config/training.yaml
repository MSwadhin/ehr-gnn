# GNN training configuration.

task:
  name: "multi_label_diagnosis_prediction"
  label_level: "visit"
  target_node_type: "visit"
  num_labels: 128     # placeholder; replace with actual count later

model:
  type: graphsage       # or "gcn"
  hidden_dim: 128
  num_layers: 2
  dropout: 0.5
  aggregator: mean

training:
  num_epochs: 10
  batch_size: 1024
  lr: 0.001
  weight_decay: 0.0005
  optimizer: adam       # not used yet, but fine to keep

sampling:
  use_neighbor_sampling: true
  fanouts: [10, 10]
  num_workers: 0

loss:
  type: "binary_cross_entropy_with_logits"
  pos_weight_path: null


evaluation:
  metrics:
    - "precision_at_k"
  precision_at_k:
    ks: [5, 10]

  eval_interval_epochs: 1

  early_stopping:
    enabled: true
    patience: 5
    metric: "precision_at_k@5"
    mode: "max"
